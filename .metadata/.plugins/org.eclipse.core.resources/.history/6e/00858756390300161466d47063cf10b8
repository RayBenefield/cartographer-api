package com.cartographerapi.domain;

import java.util.List;
import java.util.Map;
import java.util.HashMap;
import com.amazonaws.services.dynamodbv2.AmazonDynamoDBClient;
import com.amazonaws.services.dynamodbv2.model.AttributeValue;
import com.amazonaws.services.dynamodbv2.datamodeling.DynamoDBMapper;
import com.amazonaws.regions.Region;
import com.amazonaws.regions.Regions;

public class PlayerGamesDynamoReader implements PlayerGamesReader {

	private AmazonDynamoDBClient client;
	private DynamoDBMapper dbMapper;

	public PlayerGamesDynamoReader() {
		client = new AmazonDynamoDBClient();
		client.setRegion(Region.getRegion(Regions.US_WEST_2));
		dbMapper = new DynamoDBMapper(client);
	}

	@Override
	public List<PlayerGame> getPlayerGamesByGamertag(String gamertag) {
        Map<String, AttributeValue> eav = new HashMap<String, AttributeValue>();
        eav.put(":val1", new AttributeValue().withS(gamertag));

        DynamoDBQueryExpression<Reply> queryExpression = new DynamoDBQueryExpression<Reply>()
                .withKeyConditionExpression("Id = :val1")
                .withExpressionAttributeValues(eav);
                    
		List<Reply> betweenReplies = dbMapper.query(PlayerGame.class, queryExpression);
		return null;
	}

}
