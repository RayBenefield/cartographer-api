package com.cartographerapi.domain;

import java.util.List;

public class GamesSnsWriter implements GamesWriter {
	
	private String topicArn;
	private AmazonSNSClient snsClient;
	private ObjectMapper mapper;

	@Override
	public Game saveGame(Game game) {
		// TODO clean up try catch
		try {
			for (PlayerGame game : games) {
				PublishRequest publishRequest;
				publishRequest = new PublishRequest(topicArn, mapper.writeValueAsString(game));
				snsClient.publish(publishRequest);
			}
		} catch (JsonGenerationException e) {
			e.printStackTrace();
		} catch (JsonMappingException e) {
			e.printStackTrace();
		} catch (JsonProcessingException e) {
			e.printStackTrace();
		}
		return games;
	}

	@Override
	public List<Game> saveGames(List<Game> games) {

	}
	
	public GamesSnsWriter(String topicArn) {
		this.topicArn = topicArn;
        mapper = new ObjectMapper();
        snsClient = new AmazonSNSClient();		                           
        snsClient.setRegion(Region.getRegion(Regions.US_WEST_2));
	}

}
